# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/eeb-177-final-project/pyrate/pyrate_mcmc_logs/eq_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/eeb-177-final-project/pyrate/pyrate_mcmc_logs/eq_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.0617471839359, 0.0617471839359,0.0611011505216,0.061277210188,0.0617471839359,0.0617804039446,0.061027688235,0.0612767312037,0.0612767312037,0.0612767312037,0.0617222009379,0.0612767312037,0.0612767312037,0.061027688235,0.061027688235,0.0600213365912,0.0617471839359,0.0611011505216,0.0585973266659,0.0568877689849,0.0538666946813,0.0702484446861,0.0916537911111,0.0942345656541,0.0949883519853,0.0949883519853,0.0949883519853,0.0905432146636,0.0949883519853,0.0949883519853,0.0949393505353,0.0948265097089,0.0949393505353,0.0948265097089,0.0939446715043,0.0894330425013,0.0896215915916,0.0900975522681,0.0932643458276,0.0853490270041,0.0853330136929,0.0854328965506,0.0852353997755,0.0852353997755,0.0852353997755,0.0853330136929,0.0852353997755,0.0853330136929,0.0853330136929,0.0852353997755,0.0852353997755,0.0852353997755,0.0837239474578,0.0827450940219,0.0786944291102)
L_hpd_M95=c(0.125631156567, 0.125631156567,0.122576421155,0.121351174364,0.118080450246,0.117361260499,0.115590026849,0.114873536374,0.114895858532,0.114873536374,0.115160258536,0.11486319048,0.115158685662,0.115160258536,0.115590026849,0.114919759321,0.117116374365,0.117751593835,0.117751593835,0.124561142553,0.225061136775,0.36106724201,0.380471798788,0.380471798788,0.380435030967,0.378008704411,0.368622756679,0.345651367431,0.337482850306,0.329880740069,0.319321231167,0.313195714644,0.305575783378,0.301435249353,0.296075507965,0.287103801511,0.285646647651,0.285517443912,0.285646647651,0.275936291689,0.274604116841,0.273909973611,0.272344835969,0.271426078209,0.269154596541,0.268208574652,0.268666068961,0.268666068961,0.267925626601,0.268608798317,0.269112119481,0.268608798317,0.267925626601,0.267925626601,0.267905915844)
M_hpd_m95=c(0.250748834033, 0.250748834033,0.123154057263,0.124924058947,0.12766529038,0.126641936112,0.0426509342522,0.0415875631897,0.0371653853422,0.0293198308249,0.0332842863969,0.0334723876317,0.0334723876317,0.0333865851385,0.0335906449253,0.0327040305247,0.0333865851385,0.0327040305247,0.0317799928968,0.0318549879016,0.0317799928968,0.0303241448121,0.0293959973334,0.0291155435604,0.0293198308249,0.0291155435604,0.0303241448121,0.030420442834,0.0293959973334,0.0291155435604,0.0329666911535,0.0374894828914,0.0387578005948,0.0413937982018,0.042430060224,0.0441566973116,0.0450758355319,0.0462730838141,0.0482939829916,0.0523144448325,0.0549154364885,0.0570774840336,0.0570774840336,0.0570774840336,0.0570774840336,0.0574807256933,0.0574807256933,0.0570925310435,0.0556379328939,0.0551642433138,0.0478111462148,0.00579816234898,0.0037133759179,0.0037133759179,0.00347055863578)
M_hpd_M95=c(1.62530392386, 1.62530392386,0.404037836775,0.404657767111,0.404816271318,0.404816271318,0.282129824548,0.239384045898,0.210645704979,0.106319716831,0.0781533471731,0.0747310574578,0.0726928369545,0.0718933451146,0.0716814102836,0.070328359925,0.070092318785,0.0690875885763,0.0687237358586,0.0690263809399,0.0690263809399,0.0697324958903,0.0738931558066,0.0929486217864,0.104079944018,0.112842132726,0.11816649063,0.126117051311,0.138648141828,0.149190358443,0.180116614586,0.204308338663,0.209607369133,0.212150060461,0.212150060461,0.212133203922,0.212133203922,0.21259045667,0.213697596942,0.218739722147,0.221283348816,0.223325619716,0.223749569419,0.223435547625,0.223749569419,0.223325619716,0.223325619716,0.223153238777,0.2235673023,0.223153238777,0.230457762674,0.195079588613,0.158970120842,0.141471855477,0.134582600563)
R_hpd_m95=c(-1.54262463795, -1.54262463795,-0.324546882464,-0.324546882464,-0.324546882464,-0.324546882464,-0.208097022418,-0.16780294432,-0.133049314587,-0.0312291187539,-0.00563586767465,-0.00234685339527,-0.00134912399151,-0.00117562055958,-0.00117562055958,-0.00071954764919,-0.00117562055958,0.000369546755271,-0.00261780066779,-0.00868102878585,-0.00258340083131,0.0129199161109,0.0336965890007,0.0328655762779,0.0326522219514,0.0328655762779,0.0288388613614,0.0220582730641,0.00590821277864,0.0015220263563,-0.0346390612389,-0.0772778540748,-0.0772778540748,-0.0774508748857,-0.0797760446105,-0.0772778540748,-0.0826500601435,-0.0847418437182,-0.0826500601435,-0.0846583161659,-0.085490183669,-0.0908282248014,-0.0908282248014,-0.0991503725003,-0.0990055271166,-0.0991503725003,-0.0990055271166,-0.0973653378675,-0.0991503725003,-0.0991503725003,-0.100187464408,-0.0760068790894,-0.0315374356568,-0.0129581342907,-0.00963694922889)
R_hpd_M95=c(-0.161293405367, -0.161293405367,-0.0203827147079,-0.0215210325322,-0.028237192648,-0.031036728834,0.049025609562,0.05088921584,0.06554112952,0.0790414164366,0.0706261224126,0.0703423612487,0.0697548462312,0.0696777939146,0.0696618840013,0.0697548462312,0.0696777939146,0.0715448603164,0.0726599256182,0.0804851303218,0.183470208292,0.310216179401,0.326892449464,0.326892449464,0.325527696455,0.326751309649,0.321093544839,0.304974841138,0.288492476819,0.288492476819,0.262949493819,0.225236910785,0.215725762496,0.209141958496,0.19925556032,0.198158344093,0.189902456159,0.182475471877,0.181824781711,0.180924642177,0.180924642177,0.17813730318,0.17813730318,0.168360074304,0.167857828554,0.165833232171,0.166384784716,0.168860710175,0.166490140447,0.166490140447,0.175085620164,0.218906940865,0.230861280268,0.236428028164,0.236960566104)
L_mean=c(0.0864433675332, 0.0864433675332,0.085914846265,0.0856367556326,0.0844908999217,0.0840207021039,0.08312451805,0.0823012922833,0.0821236272031,0.0821148728914,0.0820892516662,0.082078598248,0.0820288461607,0.0820022339911,0.0820643995288,0.0821340396316,0.0822795293541,0.0826747413889,0.083363464619,0.0853028929452,0.10293111329,0.221502195475,0.233807407708,0.235115313952,0.234596852973,0.232600472458,0.228439578235,0.220120087482,0.214118535601,0.209959423529,0.205294470954,0.202705132779,0.200301608325,0.198577251905,0.196634000323,0.194083214826,0.193446816413,0.192803549383,0.191766257188,0.190648990917,0.188791882792,0.186997455701,0.185656094975,0.1840722096,0.183004308021,0.18213835085,0.180995611558,0.180328803145,0.179238345557,0.178584459381,0.178181819813,0.178175205666,0.17831574889,0.179028879454,0.180749670842)
M_mean=c(1.10381377288, 1.10381377288,0.21544637195,0.215512677906,0.215353062972,0.21459046635,0.183980525829,0.158749514236,0.103489256431,0.0575843150169,0.0532644554956,0.0526564255881,0.0521766829582,0.0519989138794,0.0518943628295,0.0516601601715,0.0512423927732,0.050786638134,0.0506095020789,0.0505983559043,0.0506988565941,0.0510211405396,0.0517481343265,0.053923809861,0.0552476552449,0.0569235045462,0.0585266752423,0.0611685847396,0.0660401501075,0.070778327514,0.0851833401728,0.108909263255,0.118971037603,0.128001993733,0.130366367522,0.131302184282,0.134712565643,0.137240184292,0.138111301944,0.13878781283,0.139597987199,0.140679320707,0.141898778145,0.142356567851,0.142826398012,0.142916009969,0.142721951848,0.141777715964,0.140295315986,0.139661639442,0.135916000359,0.107066126265,0.0725484982077,0.063175166374,0.0598846726792)
R_mean=c(-1.01737040534, -1.01737040534,-0.129531525685,-0.129875922274,-0.13086216305,-0.130569764246,-0.100856007779,-0.0764482219525,-0.0213656292276,0.0245305578745,0.0288247961706,0.0294221726599,0.0298521632025,0.0300033201118,0.0301700366993,0.0304738794601,0.0310371365808,0.0318881032549,0.03275396254,0.0347045370409,0.0522322566957,0.170481054935,0.182059273382,0.181191504091,0.179349197728,0.175676967912,0.169912902993,0.158951502742,0.148078385493,0.139181096015,0.120111130781,0.093795869524,0.081330570722,0.0705752581718,0.0662676328012,0.0627810305446,0.05873425077,0.0555633650911,0.053654955244,0.0518611780869,0.0491938955922,0.0463181349941,0.0437573168302,0.0417156417485,0.0401779100092,0.0392223408816,0.03827365971,0.0385510871811,0.0389430295709,0.0389228199384,0.0422658194547,0.0711090794003,0.105767250683,0.11585371308,0.120864998163)
trans=0.5
age=(0:(55-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.418518978667), xlim = c(-57.75,2.75), ylab = 'Speciation rate', xlab = 'Ma',main='eq' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.78783431624), xlim = c(-57.75,2.75), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.69688710175, 0.35958169441), xlim = c(-57.75,2.75), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-57.75,2.75), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()